
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="protocol.html">
      
      
        <link rel="next" href="sync.html">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>Protocol messages - Mosaic</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.8608ea7d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="style.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#protocol-messages" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Mosaic" class="md-header__button md-logo" aria-label="Mosaic" data-md-component="logo">
      
  <img src="img/favicon-96x96.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mosaic
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Protocol messages
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="index.html" class="md-tabs__link">
          
  
  Introduction

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="front.html" class="md-tabs__link">
          
  
  Mosaic Core

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="microblog.html" class="md-tabs__link">
          
  
  App: Social Media

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="applications.html" class="md-tabs__link">
          
  
  Registries

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Mosaic" class="md-nav__button md-logo" aria-label="Mosaic" data-md-component="logo">
      
  <img src="img/favicon-96x96.png" alt="logo">

    </a>
    Mosaic
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="notation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Notation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="facts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical Facts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="status.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Status and Development
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="principles.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Principles of Design
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Mosaic Core
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Mosaic Core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="front.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Front Matter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Identity and Location
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Identity and Location
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="identity.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Identity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="bootstrap.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bootstrap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="url.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    URL
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Data Formats
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Data Formats
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="timestamps.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timestamps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="kind.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kind
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tags.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tags
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="record.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Record Format
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="filter.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="human_readable_content.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Human Readable Content
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reference.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    References
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" checked>
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Protocol
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Protocol
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="network.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="protocol.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Protocol
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Protocol messages
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="messages.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Protocol messages
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#protocol-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      Protocol Extensions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#asynchronous" class="md-nav__link">
    <span class="md-ellipsis">
      Asynchronous
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#messages" class="md-nav__link">
    <span class="md-ellipsis">
      Messages
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#client-messages" class="md-nav__link">
    <span class="md-ellipsis">
      Client Messages
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Client Messages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hello" class="md-nav__link">
    <span class="md-ellipsis">
      Hello
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hello-auth" class="md-nav__link">
    <span class="md-ellipsis">
      Hello Auth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get" class="md-nav__link">
    <span class="md-ellipsis">
      Get
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query" class="md-nav__link">
    <span class="md-ellipsis">
      Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subscribe" class="md-nav__link">
    <span class="md-ellipsis">
      Subscribe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unsubscribe" class="md-nav__link">
    <span class="md-ellipsis">
      Unsubscribe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#submission" class="md-nav__link">
    <span class="md-ellipsis">
      Submission
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dht-lookup" class="md-nav__link">
    <span class="md-ellipsis">
      DHT Lookup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#server-messages" class="md-nav__link">
    <span class="md-ellipsis">
      Server Messages
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Server Messages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hello-ack" class="md-nav__link">
    <span class="md-ellipsis">
      Hello Ack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#record" class="md-nav__link">
    <span class="md-ellipsis">
      Record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#locally-complete" class="md-nav__link">
    <span class="md-ellipsis">
      Locally Complete
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-closed" class="md-nav__link">
    <span class="md-ellipsis">
      Query Closed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#submission-result" class="md-nav__link">
    <span class="md-ellipsis">
      Submission Result
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dht-response" class="md-nav__link">
    <span class="md-ellipsis">
      DHT Response
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unrecognized" class="md-nav__link">
    <span class="md-ellipsis">
      Unrecognized
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="sync.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sync
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Transports
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Transports
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="transports.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transports
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="websockets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WebSockets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="quic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QUIC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tcp.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TCP with TLS
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Accessory
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Accessory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="human_encodings.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Human Encodings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="encrypted_secret_key.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Encrypted Secret Key
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Core Application
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Core Application
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="keyschedule.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Key Schedule Record
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="profile.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Profile Record
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="core_tags.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Core Tags
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="friends.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acquaintences and Friends
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reporting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reporting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
        
          
          <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Appendices
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            Appendices
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cryptography.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cryptography
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="rationale.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rationale
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    App: Social Media
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            App: Social Media
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="microblog.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microblogging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reply_comment.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reply Comment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="blog.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="chat.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chat
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Registries
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Registries
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="applications.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Application Registry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="kinds.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Record Kind Registry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tag_types.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tag Type Registry
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#protocol-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      Protocol Extensions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#asynchronous" class="md-nav__link">
    <span class="md-ellipsis">
      Asynchronous
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#messages" class="md-nav__link">
    <span class="md-ellipsis">
      Messages
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#client-messages" class="md-nav__link">
    <span class="md-ellipsis">
      Client Messages
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Client Messages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hello" class="md-nav__link">
    <span class="md-ellipsis">
      Hello
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hello-auth" class="md-nav__link">
    <span class="md-ellipsis">
      Hello Auth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get" class="md-nav__link">
    <span class="md-ellipsis">
      Get
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query" class="md-nav__link">
    <span class="md-ellipsis">
      Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subscribe" class="md-nav__link">
    <span class="md-ellipsis">
      Subscribe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unsubscribe" class="md-nav__link">
    <span class="md-ellipsis">
      Unsubscribe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#submission" class="md-nav__link">
    <span class="md-ellipsis">
      Submission
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dht-lookup" class="md-nav__link">
    <span class="md-ellipsis">
      DHT Lookup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#server-messages" class="md-nav__link">
    <span class="md-ellipsis">
      Server Messages
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Server Messages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hello-ack" class="md-nav__link">
    <span class="md-ellipsis">
      Hello Ack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#record" class="md-nav__link">
    <span class="md-ellipsis">
      Record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#locally-complete" class="md-nav__link">
    <span class="md-ellipsis">
      Locally Complete
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-closed" class="md-nav__link">
    <span class="md-ellipsis">
      Query Closed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#submission-result" class="md-nav__link">
    <span class="md-ellipsis">
      Submission Result
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dht-response" class="md-nav__link">
    <span class="md-ellipsis">
      DHT Response
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unrecognized" class="md-nav__link">
    <span class="md-ellipsis">
      Unrecognized
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="protocol-messages">Protocol messages</h1>
<p>Protocol message are not separately digitally signed due to the TLS
transport and certificate authentication.</p>
<p>All protocol messages start with the same 4 byte sequence consisting
of one byte for the type, and three bytes for the full byte length of
the entire protocol message encoded in little-endian format. This
allows the protocol to be easily framed within a stream.</p>
<h2 id="protocol-extensions">Protocol Extensions</h2>
<p>Protocol extension negotiation is done on a transport-by-transport level.
For <a href="quic.html">QUIC</a> transport this is done with the initial packet.
For <a href="websockets.html">WebSockets</a> transport this is done with the
<code>X-Mosaic-Extensions</code> header. See the specific transport.</p>
<p>The following extensions have been defined:</p>
<ul>
<li><a href="sync.html">Sync</a></li>
</ul>
<h2 id="asynchronous">Asynchronous</h2>
<p>All client messages initiate an action, and all server messages are in
response to client messages (NOTE: this MAY not apply to Mosaic
extensions). Yet messaging is asychronous and both sides SHOULD be
prepared to deal with a message sent at any time.</p>
<p>Servers SHOULD not send messages until they receive a message that
requires a response.</p>
<p>If a server fails to receive a message from a client that does not
have an open query or submission within a reasonable timeframe, it
MAY close the connection.</p>
<p>If a client receives a server message that was not expected, it MUST
ignore it and decide what to do next. In some cases, clients MAY close
the connection because the service they were seeking failed. In other
cases they MAY try something else. There is no provision for a client
to alert a server of an error.</p>
<h2 id="messages">Messages</h2>
<p>Every message starts with a one-byte type, shown below in the header
of each type. Following this is the data of the message.</p>
<table>
<thead>
<tr>
<th>Initiator</th>
<th>Message</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>Client</td>
<td><a href="#hello">Hello</a></td>
<td>0x10</td>
</tr>
<tr>
<td>Client</td>
<td><a href="#hello-auth">Hello Auth</a></td>
<td>0x11</td>
</tr>
<tr>
<td>Client</td>
<td><a href="#get">Get</a></td>
<td>0x1</td>
</tr>
<tr>
<td>Client</td>
<td><a href="#query">Query</a></td>
<td>0x2</td>
</tr>
<tr>
<td>Client</td>
<td><a href="#subscribe">Subscribe</a></td>
<td>0x3</td>
</tr>
<tr>
<td>Client</td>
<td><a href="#unsubscribe">Unsubscribe</a></td>
<td>0x4</td>
</tr>
<tr>
<td>Client</td>
<td><a href="#submission">Submission</a></td>
<td>0x5</td>
</tr>
<tr>
<td>Client</td>
<td><a href="#dht-lookup">DHTLookup</a></td>
<td>0x6</td>
</tr>
<tr>
<td>Server</td>
<td><a href="#hello-ack">Hello Ack</a></td>
<td>0x90</td>
</tr>
<tr>
<td>Server</td>
<td><a href="#record">Record</a></td>
<td>0x80</td>
</tr>
<tr>
<td>Server</td>
<td><a href="#locally-complete">Locally Complete</a></td>
<td>0x81</td>
</tr>
<tr>
<td>Server</td>
<td><a href="#query-closed">Query Closed</a></td>
<td>0x82</td>
</tr>
<tr>
<td>Server</td>
<td><a href="#submission-result">Submission Result</a></td>
<td>0x83</td>
</tr>
<tr>
<td>Server</td>
<td><a href="#dht-response">DHTResponse</a></td>
<td>0x84</td>
</tr>
<tr>
<td>Either</td>
<td><a href="#unrecognized">Unrecognized</a></td>
<td>0xF0</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="client-messages">Client Messages</h2>
<h3 id="hello">Hello</h3>
<p>NOTE: Some transports send HELLO information out of band. Refer to the transport in
question:</p>
<ul>
<li><a href="quic.html">QUIC</a></li>
<li><a href="tcp.html">TCP</a></li>
<li><a href="websockets.html">WebSockets</a></li>
</ul>
<p>TBD</p>
<h3 id="hello-auth">Hello Auth</h3>
<p>NOTE: Some transports send HELLO AUTH information out of band. Refer to the transport in
question:</p>
<ul>
<li><a href="quic.html">QUIC</a></li>
<li><a href="tcp.html">TCP</a></li>
<li><a href="websockets.html">WebSockets</a></li>
</ul>
<p>TBD</p>
<h3 id="get">Get</h3>
<p>This is a query for specific records.</p>
<p>It has the following format:</p>
<pre><code class="language-text">
    0     1     2     3     4     5     6     7     8
 0  +-----------------------------------------------+
    | 0x1 |     LENGTH      | QUERY_ID  |   0x0     |
 8  +-----------------------------------------------+
    | Mixed IDs or ADDRs, each one 48 bytes long... |
    | ...                                           |
    +-----------------------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0x1</li>
<li><code>[1:4]</code> - The byte length of this message, in little-endian format</li>
<li><code>[4:6]</code> - <code>QUERY_ID</code>, two bytes which SHOULD be made up by the client and
  used to associate returned <a href="#record"><code>Record</code></a> responses to this request.</li>
<li><code>[6:8]</code> - Zeroed</li>
<li><code>[*]</code> - A sequence of mixed IDs and ADDRs.  Note that ADDRs start
  with a 1 bit, whereas IDs start with a 0 bit, and both of them are 48
  bytes long.</li>
</ul>
<p>This is a client initiated message. Servers are expected to reply with:</p>
<ul>
<li>A series of zero or more <a href="#record"><code>Record</code></a> messages representing all
  the matched records on the server, followed by a
  <a href="#query-closed"><code>Query Closed</code></a> message.</li>
</ul>
<h3 id="query">Query</h3>
<p>This is a query for records that closes once served.</p>
<p>It has the following format:</p>
<pre><code class="language-text">    0     1     2     3     4     5     6     7     8
 0  +-----------------------------------------------+
    | 0x2 |     LENGTH      | QUERY_ID  |  LIMIT    |
 8  +-----------------------------------------------+
    | FILTER ...                                    |
    | ...                                           |
    +-----------------------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0x2</li>
<li><code>[1:4]</code> - The byte length of this message, in little-endian format</li>
<li><code>[4:6]</code> - <code>QUERY_ID</code> two bytes which SHOULD be made up by the client and used
  to associate returned <a href="#record"><code>Record</code></a> responses to this request.</li>
<li><code>[6:8]</code> - <code>LIMIT</code>, an unsigned integer in little-endian format, specifies
  the maximum number of responses that the client wishes to receive.  A value
  of 0 indicates unlimited.</li>
<li><code>[*]</code> - The <code>FILTER</code>, see <a href="filter.html">Filter</a>.</li>
</ul>
<p>This is a client initiated message. Servers are expected to reply with:</p>
<ul>
<li>a series of zero or more <a href="#record"><code>Record</code></a> messages representing all
  the matching records on the server initially, followed by
  a <a href="#query-closed"><code>Query Closed</code></a> message.</li>
</ul>
<p>Queries MUST return results in anti-chronological order, from most
recent backwards.</p>
<h3 id="subscribe">Subscribe</h3>
<p>This is a query for records that is kept open after the initial records are
served so that newly arriving records that match can be sent to the client
immediately.</p>
<p>It has the following format:</p>
<pre><code class="language-text">    0     1     2     3     4     5     6     7     8
 0  +-----------------------------------------------+
    | 0x3 |     LENGTH      | QUERY_ID  |   LIMIT   |
 8  +-----------------------------------------------+
    | FILTER ...                                    |
    | ...                                           |
    +-----------------------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0x3</li>
<li><code>[1:4]</code> - The byte length of this message, in little-endian format</li>
<li><code>[4:6]</code> - <code>QUERY_ID</code>, two bytes which SHOULD be made up by the client and
  used to associate returned <a href="#record"><code>Record</code></a> responses to this request.</li>
<li><code>[6:8]</code> - <code>LIMIT</code>, an unsigned integer in little-endian format, specifies
  the maximum number of responses that the client wishes to receive.  A value
  of 0 indicates unlimited.</li>
<li><code>[*]</code> - The <code>FILTER</code>, see <a href="filter.html">Filter</a>.</li>
</ul>
<p>This is a client initiated message. Servers are expected to reply with:</p>
<ul>
<li>a series of zero or more <a href="#record"><code>Record</code></a> messages representing all
  the matching records on the server initially, followed by
  a <a href="#locally-complete"><code>Locally Complete</code></a> message, potentially followed by
  zero or
  more <a href="#record"><code>Record</code></a> messages that flow in to the server after
  the initial response (so long as the query is still open), or</li>
<li>a <a href="#query-closed"><code>Query Closed</code></a> message if the query could not be served.</li>
</ul>
<p>Queries MUST return results in anti-chronological order, from most
recent backwards.</p>
<h3 id="unsubscribe">Unsubscribe</h3>
<p>This is a client request to close an open subscription query.</p>
<p>It has the following format:</p>
<pre><code class="language-text">    0     1     2     3     4     5     6     7     8
 0  +-----------------------------------------------+
    | 0x4 |     LENGTH      | QUERY_ID  |   0x0     |
 8  +-----------------------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0x3</li>
<li><code>[1:4]</code> - The byte length of this message, in little-endian format</li>
<li><code>[4:6]</code> - <code>QUERY_ID</code>, two bytes indicating which query SHOULD be closed.</li>
<li><code>[4:8]</code> - Zeroed</li>
</ul>
<p>This is a client initiated message. Servers are expected to reply with:</p>
<ul>
<li><a href="#query-closed"><code>Query Closed</code></a></li>
</ul>
<h3 id="submission">Submission</h3>
<p>This is the submission of a record.</p>
<p>It has the following format:</p>
<pre><code class="language-text">    0     1     2     3     4     5     6     7     8
 0  +-----------------------------------------------+
    | 0x5 |    LENGTH       |          0x0          |
 8  +-----------------------------------------------+
    | RECORD ...                                    |
    | ...                                           |
    +-----------------------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0x5</li>
<li><code>[1:4]</code> - The byte length of this message, in little-endian format</li>
<li><code>[4:8]</code> - Zeroed</li>
<li><code>[*]</code> - <code>RECORD</code> is the record submitted</li>
</ul>
<p>This is a client initiated message. Servers are expected to reply with:</p>
<ul>
<li><a href="#submission-result"><code>Submission Result</code></a> with an id prefix matching the record.</li>
</ul>
<h3 id="dht-lookup">DHT Lookup</h3>
<p>Browser-based JavaScript clients cannot do DHT lookups. This requests that the server perform a DHT lookup on behalf of the client</p>
<p>TBD</p>
<hr />
<h2 id="server-messages">Server Messages</h2>
<h3 id="hello-ack">Hello Ack</h3>
<p>NOTE: Some transports send HELLO AUTH information out of band. Refer to the transport in
question:</p>
<ul>
<li><a href="quic.html">QUIC</a></li>
<li><a href="tcp.html">TCP</a></li>
<li><a href="websockets.html">WebSockets</a></li>
</ul>
<p>TBD</p>
<h3 id="record">Record</h3>
<p>This is a record returned from a query.</p>
<p>It has the following format:</p>
<pre><code class="language-text">    0     1     2     3     4     5     6     7     8
 0  +-----------------------------------------------+
    | 0x80|     LENGTH      | QUERY_ID  |   0x0     |
 8  +-----------------------------------------------+
    | RECORD ...                                    |
    | ...                                           |
    +-----------------------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0x80</li>
<li><code>[1:4]</code> - The byte length of this message, in little-endian format</li>
<li><code>[4:6]</code> - <code>QUERY_ID</code> indicates the client query that this record matched.</li>
<li><code>[6:8]</code> - Zeroed</li>
<li><code>[*]</code> - <code>RECORD</code> is the returned record.</li>
</ul>
<p>This is a server response message in response to <a href="#get"><code>Get</code></a>
or <a href="#query"><code>Query</code></a> or <a href="#subscribe"><code>Subscribe</code></a>.</p>
<h3 id="locally-complete">Locally Complete</h3>
<p>This is a message indicating that a query has served all matching local records,
but remains open to serve matching records that subsequently arrive.</p>
<p>It has the following format:</p>
<pre><code class="language-text">    0     1     2     3     4     5     6     7     8
 0  +-----------------------------------------------+
    | 0x81|     LENGTH      |  QUERY_ID |    0x0    |
 8  +-----------------------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0x81</li>
<li><code>[1:4]</code> - The byte length of this message, in little-endian format</li>
<li><code>[4:6]</code> - <code>QUERY_ID</code> indicates the client query that is now locally complete.</li>
<li><code>[6:8]</code> - zeroed</li>
</ul>
<p>This is a server response message in response to <a href="#subscribe"><code>Subscribe</code></a>.</p>
<h3 id="query-closed">Query Closed</h3>
<p>This is a message indicating that a query has been closed.</p>
<p>It has the following format:</p>
<pre><code class="language-text">    0     1     2     3     4     5     6     7     8
 0  +-----------------------------------------------+
    | 0x82|     LENGTH      |  QUERY_ID | CODE| 0x0 |
 8  +-----------------------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0x82</li>
<li><code>[1:4]</code> - The byte length of this message, in little-endian format</li>
<li><code>[4:6]</code> - <code>QUERY_ID</code> indicates the client query that is now closed.</li>
<li><code>[6:7]</code> - <code>CODE</code> indicates the reason for closure from among the
  following defined reasons:<ul>
<li><code>ON_REQUEST</code>: 0x1 - Query was closed in response to an <a href="#unsubscribe"><code>Unsubscribe</code></a> request</li>
<li><code>REJECTED_INVALID</code>: 0x10 - Query is invalid</li>
<li><code>REJECTED_TOO_OPEN</code>: 0x11 - Query is too broad, matching too many records</li>
<li><code>REJECTED_TOO_FAST</code>: 0x12 - Queries (or messages) are coming too quickly. Slow down</li>
<li><code>REJECTED_TEMP_BANNED</code>: 0x13 - Client is temporarily banned from querying</li>
<li><code>REJECTED_PERM_BANNED</code>: 0x14 - Client is permanently banned from querying</li>
<li><code>SHUTTING_DOWN</code>: 0x30 - The server is shutting down</li>
<li><code>INTERNAL_ERROR</code>: 0xF0 - The server has encountered an internal error</li>
<li><code>OTHER</code>: 0xFF - Other reason, or not specified</li>
</ul>
</li>
<li><code>[7:8]</code> - zero</li>
</ul>
<h3 id="submission-result">Submission Result</h3>
<p>This is a message returning the result of a <a href="#submission">Submission</a>.</p>
<p>It has the following format:</p>
<pre><code class="language-text">    0     1     2     3     4     5     6     7     8
 0  +-----------------------------------------------+
    | 0x83|     LENGTH      |CODE |      0x0        |
 8  +-----------------------------------------------+
    | ID PREFIX bytes 0..8                          |
16  +-----------------------------------------------+
    | ID PREFIX bytes 8..16                         |
24  +-----------------------------------------------+
    | ID PREFIX bytes 16..24                        |
32  +-----------------------------------------------+
    | ID PREFIX bytes 24..32                        |
40  +-----------------------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0x83</li>
<li><code>[1:4]</code> - The byte length of this message, in little-endian format</li>
<li><code>[4:5]</code> - <code>CODE</code> which indicates the result of the submission from among the
  following defined results:<ul>
<li><code>OK</code>: 0x1 - Record submission was accepted</li>
<li><code>DUPLICATE</code>: 0x2 - Record is a duplicate. Servers MAY use this or
  they MAY use <code>OK</code> in the same circumstance.</li>
<li><code>NO_CONSUMERS</code>: 0x3 - Ephemeral record had no consumers. Servers MAY use this or
  they MAY use <code>OK</code> in the same circumstance.</li>
<li><code>REJECTED_INVALID</code>: 0x10 - Record is invalid</li>
<li><code>REJECTED_TOO_FAST</code>: 0x12 - Submissions (or messages) are coming too quickly. Slow down.</li>
<li><code>REJECTED_TEMP_BANNED</code>: 0x13 - Client is temporarily banned from submisisons.</li>
<li><code>REJECTED_PERM_BANNED</code>: 0x14 - Client is permanently banned from submissions.</li>
<li><code>REJECTED_REQUIRES_AUTHN</code>: 0x15 - Submission requires authentication.</li>
<li><code>REJECTED_REQUIRES_AUTHZ</code>: 0x16 - Submission requires authorization.</li>
<li><code>INTERNAL_ERROR</code>: 0xF0 - The server has encountered an internal error</li>
<li><code>OTHER</code>: 0xFF - Other reason, or not specified</li>
</ul>
</li>
<li><code>[5:8]</code> - Zeroed</li>
<li><code>[8:40]</code> - A 32-byte prefix of the 48-byte Id.</li>
</ul>
<h3 id="dht-response">DHT Response</h3>
<p>This is a server response to a <a href="#dht-lookup"><code>DHTLookup</code></a> request.</p>
<p>TBD</p>
<h3 id="unrecognized">Unrecognized</h3>
<p>This is a message indicating that the last message from the peer was not recognized.</p>
<p>When this is received over QUIC transport, the stream SHOULD be closed and further messaging
can occur on other streams.</p>
<p>It has the following format:</p>
<pre><code class="language-text">    0     1     2     3     4     5     6     7     8
 0  +-----------------------------------------------+
    | 0xF0|     LENGTH      |         0x0           |
 8  +-----------------------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0xF0</li>
<li><code>[1:4]</code> - The byte length of this message, in little-endian format</li>
<li><code>[4:8]</code> - Zeroed</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
      <div class="md-copyright">
        <i>Mike Dilger edition, version 0.1.2</i>
      </div>
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.path"], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>