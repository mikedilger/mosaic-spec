<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>Filter - Mosaic</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="style.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Filter";
        var mkdocs_page_input_path = "filter.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="index.html">
          <img src="img/favicon-96x96.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="index.html">Mosaic Introduction</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="status.html">Status and Development</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="rationale.html">Rationale</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Mosaic Core</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" >Identity</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="cryptography.html">Cryptography</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="identity.html">Identity</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="url.html">URL</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="bootstrap.html">Bootstrap</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Record Type</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="timestamps.html">Timestamps</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="record.html">Record Format</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="human_readable_content.html">Human Readable Content</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="core_tags.html">Core Tags</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="reference.html">References</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Core Records</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="keyschedule.html">Key Schedule Record</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="profile.html">Profile Record</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" >Protocol</a>
    <ul class="current">
                <li class="toctree-l2 current"><a class="reference internal current" href="#">Filter</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="protocol.html">Core Protocol</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Registries</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="tag_types.html">Tag Type Registry</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="kinds.html">Record Kind Registry</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Mosaic Accessory</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="human_encodings.html">Human Encodings</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Mosaic Transport</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="quic.html">QUIC</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="websockets.html">WebSockets</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Extensions</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="sync_protocol_extension.html">Sync Protocol Extension</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Applications</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Mosaic Social media</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="microblog.html">Microblogging</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="blog.html">Blog</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="reply_comment.html">Reply Comment</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="chat.html">Chat</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Mosaic</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html" class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Mosaic Core</li>
          <li class="breadcrumb-item">Protocol</li>
      <li class="breadcrumb-item active">Filter</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="filter">Filter</h1>
<p><status>PAGE STATUS: early draft</status></p>
<p>A filter is a binary structure used within the <a href="protocol.html">Core Protocol</a>.</p>
<p>It is defined as a contiguous sequence of selectors.
Each selector restricts the set of records that the filter matches.
For an event to pass the filter, it must pass all the selectors.</p>
<p>Most selectors are narrow (e.g. it must be one of the listed authors).
Some selectors are wide (any record after a given timestamp).
Filters SHOULD include at least one narrow selector in order
to narrow down the set of matching events to something reasonable. Software
MAY reject filters that do not comply with this requirement.</p>
<p>Filters can be up to 65536 bytes long maximum, but this size may not be
possible given other constraints.</p>
<p>Most types of selectors should only be used once, and provide for multiple
values. Tag selectors can be used multiple times, once for each type of tag.</p>
<p>The following selectors are defined:</p>
<table>
<thead>
<tr>
<th>type</th>
<th>name</th>
<th>narrow</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x1</td>
<td><a href="#exclude">Exclude</a></td>
<td>no</td>
</tr>
<tr>
<td>0x4</td>
<td><a href="#author-keys">Author Keys</a></td>
<td>yes</td>
</tr>
<tr>
<td>0x5</td>
<td><a href="#signing-keys">Signing Keys</a></td>
<td>yes</td>
</tr>
<tr>
<td>0x6</td>
<td><a href="#timestamps">Timestamps</a></td>
<td>yes</td>
</tr>
<tr>
<td>0x7</td>
<td><a href="#since">Since</a></td>
<td>no</td>
</tr>
<tr>
<td>0x8</td>
<td><a href="#until">Until</a></td>
<td>no</td>
</tr>
<tr>
<td>0xA</td>
<td><a href="#received-since">Received Since</a></td>
<td>no</td>
</tr>
<tr>
<td>0xB</td>
<td><a href="#received-until">Received Until</a></td>
<td>no</td>
</tr>
<tr>
<td>0xC</td>
<td><a href="#kinds">Kinds</a></td>
<td>yes</td>
</tr>
<tr>
<td>0xD</td>
<td><a href="#includes-tag">Includes Tag</a></td>
<td>yes</td>
</tr>
<tr>
<td>0xE</td>
<td><a href="#excludes-tag">Excludes Tag</a></td>
<td>no</td>
</tr>
</tbody>
</table>
<h2 id="exclude">Exclude</h2>
<blockquote>
<p><strong>0x1</strong></p>
</blockquote>
<p>Excludes all records with the given IDs or Addresses.</p>
<pre><code class="language-text">            1   2   3   4   4   5   6
    0   8   6   4   2   0   8   6   4
 0  +-------------------------------+
    |0x1|         0x0           | n |
 8  +-------------------------------+
    | ID or ADDR prefix bytes 0..8  |
16  +-------------------------------+
    | ID or ADDR prefix bytes 8..16 |
24  +-------------------------------+
    | ID or ADDR prefx bytes 16..24 |
32  +-------------------------------+
    | ID or ADDR prefx bytes 24..32 |
40  +-------------------------------+
    | ... additional references     |
    +-------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0x1</li>
<li><code>[1:7]</code> - Zeroed</li>
<li><code>[7:8]</code> - A 1-byte count <code>n</code> of references</li>
<li><code>[*]</code> - A sequence of <code>n</code> 32-byte ID or Address prefixes.</li>
</ul>
<h2 id="author-keys">Author Keys</h2>
<blockquote>
<p><strong>0x4</strong></p>
</blockquote>
<p>Matches all records authored by any of these keys.</p>
<pre><code class="language-text">            1   2   3   4   4   5   6
    0   8   6   4   2   0   8   6   4
 0  +-------------------------------+
    |0x4|          0x0          | n |
 8  +-------------------------------+
    | AUTHOR KEY 1/4                |
 16 +-------------------------------+
    | AUTHOR KEY 2/4                |
 24 +-------------------------------+
    | AUTHOR KEY 3/4                |
 32 +-------------------------------+
    | AUTHOR KEY 4/4                |
 40 +-------------------------------+
    | ... additional keys..         |
    +-------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0x4</li>
<li><code>[1:7]</code> - Zeroed</li>
<li><code>[7:8]</code> - A 1-byte count <code>n</code> of author keys</li>
<li><code>[*]</code> - A sequence of <code>n</code> 32-byte author public keys.</li>
</ul>
<h2 id="signing-keys">Signing Keys</h2>
<blockquote>
<p><strong>0x5</strong></p>
</blockquote>
<p>Matches all records signed by any of these keys.</p>
<pre><code class="language-text">            1   2   3   4   4   5   6
    0   8   6   4   2   0   8   6   4
 0  +-------------------------------+
    |0x5|        0x0            | n |
 8  +-------------------------------+
    | SIGNING KEY 1/4               |
 16 +-------------------------------+
    | SIGNING KEY 2/4               |
 24 +-------------------------------+
    | SIGNING KEY 3/4               |
 32 +-------------------------------+
    | SIGNING KEY 4/4               |
 40 +-------------------------------+
    | ... additional keys..         |
    +-------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0x5</li>
<li><code>[1:7]</code> - Zeroed</li>
<li><code>[7:8]</code> - A 1-byte count <code>n</code> of signing keys</li>
<li><code>[*]</code> - A sequence of <code>n</code> 32-byte signing public keys.</li>
</ul>
<h2 id="timestamps">Timestamps</h2>
<blockquote>
<p><strong>0x6</strong></p>
</blockquote>
<p>Matches all records that have any of these exact timestamps.
Typically used as part of address lookups.</p>
<pre><code class="language-text">            1   2   3   4   4   5   6
    0   8   6   4   2   0   8   6   4
 0  +-------------------------------+
    |0x6|        0x0            | n |
 8  +-------------------------------+
    |  0x0  |     TIMESTAMP         |
 16 +-------------------------------+
    | ..0x0 |    ..TIMESTAMP        |
 24 +-------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0x6</li>
<li><code>[1:7]</code> - Zeroed</li>
<li><code>[7:8]</code> - A 1-byte count <code>n</code> of timestamp fields</li>
<li><code>[*]</code> - A sequence of <code>n</code> 8-byte fields, each being:<ul>
<li><code>[0:2]</code> - Zeroed</li>
<li><code>[2:8]</code> - A six byte <a href="timestamps.html">timestamp</a>.</li>
</ul>
</li>
</ul>
<h2 id="since">Since</h2>
<blockquote>
<p><strong>0x7</strong></p>
</blockquote>
<p>Matches all records with a timestamp greater than or equal to
this value.</p>
<pre><code class="language-text">            1   2   3   4   4   5   6
    0   8   6   4   2   0   8   6   4
 0  +-------------------------------+
    |0x7|              0x0          |
 8  +-------------------------------+
    |  0x0  |     TIMESTAMP         |
 16 +-------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0x7</li>
<li><code>[1:10]</code> - Zeroed</li>
<li><code>[10:16]</code> - A six byte <a href="timestamps.html">timestamp</a>.</li>
</ul>
<h2 id="until">Until</h2>
<blockquote>
<p><strong>0x8</strong></p>
</blockquote>
<p>Matches all records with a timestamp less than this value.</p>
<pre><code class="language-text">            1   2   3   4   4   5   6
    0   8   6   4   2   0   8   6   4
 0  +-------------------------------+
    |0x8|              0x0          |
 8  +-------------------------------+
    |  0x0  |     TIMESTAMP         |
 16 +-------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0x8</li>
<li><code>[1:10]</code> - Zeroed</li>
<li><code>[10:16]</code> - A six byte <a href="timestamps.html">timestamp</a>.</li>
</ul>
<h2 id="received-since">Received Since</h2>
<blockquote>
<p><strong>0xA</strong></p>
</blockquote>
<p>Matches all records that were received by the server at or later
than this value.</p>
<pre><code class="language-text">            1   2   3   4   4   5   6
    0   8   6   4   2   0   8   6   4
 0  +-------------------------------+
    |0xA|              0x0          |
 8  +-------------------------------+
    |  0x0  |     TIMESTAMP         |
 16 +-------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0xA</li>
<li><code>[1:10]</code> - Zeroed</li>
<li><code>[10:16]</code> - A six byte <a href="timestamps.html">timestamp</a>.</li>
</ul>
<h2 id="received-until">Received Until</h2>
<blockquote>
<p><strong>0xB</strong></p>
</blockquote>
<p>Matches all records that were received by the server before
this value.</p>
<pre><code class="language-text">            1   2   3   4   4   5   6
    0   8   6   4   2   0   8   6   4
 0  +-------------------------------+
    |0xB|              0x0          |
 8  +-------------------------------+
    |  0x0  |     TIMESTAMP         |
 16 +-------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0xB</li>
<li><code>[1:10]</code> - Zeroed</li>
<li><code>[10:16]</code> - A six byte <a href="timestamps.html">timestamp</a>.</li>
</ul>
<h2 id="kinds">Kinds</h2>
<blockquote>
<p><strong>0xC</strong></p>
</blockquote>
<p>Matches all records which are of any one of these kinds.</p>
<pre><code class="language-text">            1   2   3   4   4   5   6
    0   8   6   4   2   0   8   6   4
 0  +-------------------------------+
    |0xC|          0x0          | n |
 8  +-------------------------------+
    |   KIND        |  ...KIND      |
 16 +-------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0xC</li>
<li><code>[1:7]</code> - Zeroed</li>
<li><code>[7:8]</code> - A 1-byte count <code>n</code> of kinds</li>
<li><code>[8]</code> - A sequence of <code>n</code> 4-byte <a href="kinds.html">kinds</a></li>
</ul>
<h2 id="includes-tag">Includes Tag</h2>
<blockquote>
<p><strong>0xD</strong></p>
</blockquote>
<p>Matches all records that contain the given tag.</p>
<pre><code class="language-text">            1   2   3   4   4   5   6
    0   8   6   4   2   0   8   6   4
 0  +-------------------------------+
    |0xD|0x0| TTYPE | 0x0   |  LEN  |
 8  +-------------------------------+
    |   VALUE...  .                 |
    +-------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0xD</li>
<li><code>[1:2]</code> - Zeroed</li>
<li><code>[2:4]</code> - A 2-byte <a href="tag_types.html">tag type</a> in little-endian format.</li>
<li><code>[4:6]</code> - Zeroed</li>
<li><code>[6:8]</code> - A 2-byte <code>LEN</code> unsigned integer in little-endian format
  indicating the length of the <code>VALUE</code></li>
<li><code>[*]</code> - The <code>VALUE</code> of the tag, up to 253 bytes.</li>
</ul>
<h2 id="excludes-tag">Excludes Tag</h2>
<blockquote>
<p><strong>0xE</strong></p>
</blockquote>
<p>Matches all records that do NOT contain the given tag.</p>
<pre><code class="language-text">            1   2   3   4   4   5   6
    0   8   6   4   2   0   8   6   4
 0  +-------------------------------+
    |0xE|0x0| TTYPE | 0x0   |  LEN  |
 8  +-------------------------------+
    |   VALUE...  .                 |
    +-------------------------------+
</code></pre>
<ul>
<li><code>[0:1]</code> - The type 0xE</li>
<li><code>[1:2]</code> - Zeroed</li>
<li><code>[2:4]</code> - A 2-byte <a href="tag_types.html">tag type</a> in little-endian format.</li>
<li><code>[4:6]</code> - Zeroed</li>
<li><code>[6:8]</code> - A 2-byte <code>LEN</code> unsigned integer in little-endian format
  indicating the length of the <code>VALUE</code></li>
<li><code>[*]</code> - The <code>VALUE</code> of the tag, up to 253 bytes.</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="profile.html" class="btn btn-neutral float-left" title="Profile Record"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="protocol.html" class="btn btn-neutral float-right" title="Core Protocol">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  <div>
    <i>Mike Dilger edition</i>
  </div>
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="profile.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="protocol.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script>var base_url = ".";</script>
    <script src="js/theme_extra.js"></script>
    <script src="js/theme.js"></script>
      <script src="search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
