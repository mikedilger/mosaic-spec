<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>WebSockets - Mosaic</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../style.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "WebSockets";
        var mkdocs_page_input_path = "websockets.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="..">
          <img src="../img/favicon-96x96.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Mosaic Introduction</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../status/">Status and Development</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Mosaic Core</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Identity</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../cryptography/">Cryptography</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../identity/">Identity</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../bootstrap/">Bootstrap</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Record Type</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../timestamps/">Timestamps</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../record/">Record Format</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../human_readable_content/">Human Readable Content</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../core_tags/">Core Tags</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../reference/">References</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Core Records</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../keyschedule/">Key Schedule Record</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../profile/">Profile Record</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Protocol</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../filter/">Filter</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../protocol/">Core Protocol</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Registries</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../tag_types/">Tag Type Registry</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../kinds/">Record Kind Registry</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Mosaic Accessory</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../human_encodings/">Human Encodings</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Mosaic Transport</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">WebSockets</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../webtransport/">WebTransport</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Extensions</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../sync_protocol_extension/">Sync Protocol Extension</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Applications</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Mosaic Social media</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../microblog/">Microblogging</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../blog/">Blog</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../reply_comment/">Reply Comment</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../chat/">Chat</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Mosaic</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Mosaic Transport</li>
      <li class="breadcrumb-item active">WebSockets</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="mosaic-over-websockets">Mosaic over Websockets</h1>
<p><status>PAGE STATUS: Draft</status></p>
<h2 id="tls">TLS</h2>
<p>Over WebSockets, Mosaic must use TLS version at least 1.2, preferably
<a href="https://datatracker.ietf.org/doc/html/rfc8446">TLS 1.3</a>.</p>
<p>TLS should specify the EdDSA signature algorithm, using the ed25519 signing
keys.</p>
<p>TLS certificates shall be either RawPublicKey or self-signed, and use
the ed25519 public key (either the server's master public key or the client's
signing public key).</p>
<p>Servers SHOULD request client-side certificates if they wish to authenticate
users. If clients do not provide certificates, they should be considered
anonymous. Servers MAY present different services depending on whether a user is
authenticated or not.</p>
<h2 id="websockets">WebSockets</h2>
<p>Mosaic messages are transported over
<a href="https://datatracker.ietf.org/doc/html/rfc6455">WebSockets</a></p>
<h3 id="sec-websocket-protocol">Sec-WebSocket-Protocol</h3>
<p>Clients must present the <code>Sec-WebSocket-Protocol</code> header field in the
handshake with WebSocket with the value <code>mosaic2024</code>. If this is not
presented, a server may either refuse service and close the connection,
or presume the connection is nostr (if it is dual-stack). It should not
presume the connection is Mosaic.</p>
<p>Servers MUST reply with the protocol they have accepted in the same
header, at this point being only 'mosaic2024'.</p>
<p>This subprotocol is not (as of this writing) registered with IANA, but does
not conflict with registered subprotocols.</p>
<h3 id="x-mosaic-extensions">X-Mosaic-Extensions</h3>
<p>Clients MAY present an <code>X-Mosiac-Extensions</code> header to specify the extentions
they support and may wish to use.</p>
<p>The value of an <code>X-Mosiac-Extensions</code> header is a list of extension names
separated by semicolons.</p>
<p>Clients SHOULD NOT present an <code>X-Mosaic-Extensions</code> header in the handshake
unless they are not requesting any extensions.</p>
<p>The following extension names are defined:</p>
<ul>
<li><a href="../sync_protocol_extension/">SYNC</a></li>
</ul>
<p>Servers MUST check for an <code>X-Mosaic-Extensions</code> header. If one is specified,
split it's contents on semicolons. Remove all extensions you are unable to
service. Join these back together and return an <code>X-Mosaic-Extensions</code>
header with this string. If that string was empty, use a <code>-</code> instead.</p>
<p>Clients MUST check for an <code>X-Mosaic-Extensions</code> header during negotiation,
and configure themselves to use only the extensions that the server returned
to them, considering <code>-</code> as the empty set.</p>
<h3 id="x-mosaic-service-url">X-Mosaic-Service-Url</h3>
<p>Servers MAY present a service URL for a website which users can visit in
order to manage their relationship with the server (e.g. sign up for an
account, make payment, view logs, or anything else that is relevant to
that relationship). These kinds of activities are not standardized here.</p>
<h2 id="binary">Binary</h2>
<p>All messages use websockets binary.</p>
<p>Messages are formed as the binary message protocol specified in
<a href="../protocol/">protocol</a>. Each message starts with a single byte indicating
the type, followed by the data that such type requires.</p>
<p>Clients MUST only send client messages. If a server reads a server message
from a client, it SHOULD disconnect.</p>
<p>Servers MUST only send server messages. If a client reads a client message
from a server, it SHOULD disconnect.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../human_encodings/" class="btn btn-neutral float-left" title="Human Encodings"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../webtransport/" class="btn btn-neutral float-right" title="WebTransport">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  <div>
    <i>Steve Farroll edition</i>
  </div>
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../human_encodings/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../webtransport/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
