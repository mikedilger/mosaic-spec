
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="tags.html">
      
      
        <link rel="next" href="filter.html">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>Record Format - Mosaic</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.8608ea7d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="style.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#record" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Mosaic" class="md-header__button md-logo" aria-label="Mosaic" data-md-component="logo">
      
  <img src="img/favicon-96x96.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mosaic
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Record Format
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="index.html" class="md-tabs__link">
          
  
  Introduction

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="front.html" class="md-tabs__link">
          
  
  Mosaic Core

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="microblog.html" class="md-tabs__link">
          
  
  App: Social Media

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="applications.html" class="md-tabs__link">
          
  
  Registries

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Mosaic" class="md-nav__button md-logo" aria-label="Mosaic" data-md-component="logo">
      
  <img src="img/favicon-96x96.png" alt="logo">

    </a>
    Mosaic
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="notation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Notation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="facts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical Facts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="status.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Status and Development
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="principles.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Principles of Design
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Mosaic Core
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Mosaic Core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="front.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Front Matter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Identity and Location
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Identity and Location
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="identity.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Identity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="bootstrap.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bootstrap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="url.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    URL
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Data Formats
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Data Formats
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="timestamps.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timestamps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="kind.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kind
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tags.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tags
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Record Format
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="record.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Record Format
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#maximum-size" class="md-nav__link">
    <span class="md-ellipsis">
      Maximum Size
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#layout" class="md-nav__link">
    <span class="md-ellipsis">
      Layout
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sections-and-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Sections and Fields
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sections and Fields">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#id" class="md-nav__link">
    <span class="md-ellipsis">
      ID
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ID">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#timestamp" class="md-nav__link">
    <span class="md-ellipsis">
      Timestamp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hash" class="md-nav__link">
    <span class="md-ellipsis">
      Hash
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-section" class="md-nav__link">
    <span class="md-ellipsis">
      Data Section
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Section">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#address" class="md-nav__link">
    <span class="md-ellipsis">
      Address
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Address">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unique-address-nonce" class="md-nav__link">
    <span class="md-ellipsis">
      Unique Address Nonce
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kind" class="md-nav__link">
    <span class="md-ellipsis">
      Kind
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#author-public-key" class="md-nav__link">
    <span class="md-ellipsis">
      Author Public Key
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signing-public-key" class="md-nav__link">
    <span class="md-ellipsis">
      Signing Public Key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timestamp_1" class="md-nav__link">
    <span class="md-ellipsis">
      Timestamp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flags" class="md-nav__link">
    <span class="md-ellipsis">
      Flags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lent" class="md-nav__link">
    <span class="md-ellipsis">
      LenT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LenT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lentpad" class="md-nav__link">
    <span class="md-ellipsis">
      LenTPad
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lens" class="md-nav__link">
    <span class="md-ellipsis">
      LenS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LenS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lenspad" class="md-nav__link">
    <span class="md-ellipsis">
      LenSPad
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lenp" class="md-nav__link">
    <span class="md-ellipsis">
      LenP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LenP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lenppad" class="md-nav__link">
    <span class="md-ellipsis">
      LenPPad
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tags" class="md-nav__link">
    <span class="md-ellipsis">
      Tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#payload" class="md-nav__link">
    <span class="md-ellipsis">
      Payload
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signature" class="md-nav__link">
    <span class="md-ellipsis">
      Signature
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="filter.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="human_readable_content.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Human Readable Content
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reference.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    References
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Protocol
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Protocol
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="network.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="protocol.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Protocol
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="messages.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Protocol messages
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="sync.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sync
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Transports
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Transports
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="transports.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transports
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="websockets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WebSockets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="quic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QUIC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tcp.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TCP with TLS
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Accessory
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Accessory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="human_encodings.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Human Encodings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="encrypted_secret_key.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Encrypted Secret Key
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Core Application
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Core Application
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="keyschedule.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Key Schedule Record
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="profile.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Profile Record
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="core_tags.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Core Tags
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="friends.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acquaintences and Friends
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reporting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reporting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
        
          
          <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Appendices
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            Appendices
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cryptography.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cryptography
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="rationale.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rationale
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    App: Social Media
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            App: Social Media
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="microblog.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microblogging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reply_comment.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reply Comment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="blog.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="chat.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chat
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Registries
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Registries
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="applications.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Application Registry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="kinds.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Record Kind Registry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tag_types.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tag Type Registry
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#maximum-size" class="md-nav__link">
    <span class="md-ellipsis">
      Maximum Size
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#layout" class="md-nav__link">
    <span class="md-ellipsis">
      Layout
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sections-and-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Sections and Fields
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sections and Fields">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#id" class="md-nav__link">
    <span class="md-ellipsis">
      ID
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ID">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#timestamp" class="md-nav__link">
    <span class="md-ellipsis">
      Timestamp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hash" class="md-nav__link">
    <span class="md-ellipsis">
      Hash
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-section" class="md-nav__link">
    <span class="md-ellipsis">
      Data Section
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Section">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#address" class="md-nav__link">
    <span class="md-ellipsis">
      Address
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Address">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unique-address-nonce" class="md-nav__link">
    <span class="md-ellipsis">
      Unique Address Nonce
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kind" class="md-nav__link">
    <span class="md-ellipsis">
      Kind
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#author-public-key" class="md-nav__link">
    <span class="md-ellipsis">
      Author Public Key
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signing-public-key" class="md-nav__link">
    <span class="md-ellipsis">
      Signing Public Key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timestamp_1" class="md-nav__link">
    <span class="md-ellipsis">
      Timestamp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flags" class="md-nav__link">
    <span class="md-ellipsis">
      Flags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lent" class="md-nav__link">
    <span class="md-ellipsis">
      LenT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LenT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lentpad" class="md-nav__link">
    <span class="md-ellipsis">
      LenTPad
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lens" class="md-nav__link">
    <span class="md-ellipsis">
      LenS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LenS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lenspad" class="md-nav__link">
    <span class="md-ellipsis">
      LenSPad
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lenp" class="md-nav__link">
    <span class="md-ellipsis">
      LenP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LenP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lenppad" class="md-nav__link">
    <span class="md-ellipsis">
      LenPPad
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tags" class="md-nav__link">
    <span class="md-ellipsis">
      Tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#payload" class="md-nav__link">
    <span class="md-ellipsis">
      Payload
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signature" class="md-nav__link">
    <span class="md-ellipsis">
      Signature
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="record">Record</h1>
<p>All Mosaic data is stored within Record structures (except for
bootstrap data and protocol messages).</p>
<h2 id="maximum-size">Maximum Size</h2>
<p>The <t>maximum size</t> <a href="rationale.html#maximum-size"><sup>rat</sup></a>
of a record is 1 mebibyte (1,048,576 bytes).</p>
<h2 id="layout">Layout</h2>
<pre><code class="language-text">            1   2   3   4   4   5   6
    0   8   6   4   2   0   8   6   4
  0 +-------------------------------+ &lt;-----|
    | Timestamp                     |       |
  8 +-------------------------------+       |
    | Hash 1/5                      |       |
 16 +-------------------------------+       |
    | Hash 2/5                      |  I    |
 24 +-------------------------------+  D    |
    | Hash 3/5                      |       |
 32 +-------------------------------+       |
    | Hash 4/5                      |       |
 40 +-------------------------------+       |
    | Hash 5/5                      |       |
 48 +-------------------------------+ &lt;-----|&lt;--|
    | Unique Address Nonce          |       |   |
 56 +-------------------------------+       |   |
    | Kind                          |   A   |   |
 64 +-------------------------------+   D   |   |
    | Author public key, 1/4        |   D   |   |
 72 +-------------------------------+   R   |   |
    | Author public key, 2/4        |   E   |   |
 80 +-------------------------------+   S   |   |
    | Author public key, 3/4        |   S   |   |
 88 +-------------------------------+       | D |
    | Author public key, 4/4        |       | A |
 96 +-------------------------------+ &lt;-----| T |
    | Signing public key, 1/4       |         A |
104 +-------------------------------+           |
    | Signing public key, 2/4       |         S |
112 +-------------------------------+         E |
    | Signing public key, 3/4       |         C |
120 +-------------------------------+         T |
    | Signing public key, 4/4       |         I |
128 +-------------------------------+         O |
    | Timestamp                     |         N |
136 +-------------------------------+           |
    | Flags                         |           |
144 +-------------------------------+           |
    | LenT  | LenS  | Len P         |           |
152 +-------------------------------+           |
    | Tags...                       |           |
    |                   .. +PADDING |           |
  ? +-------------------------------+           |
    | Payload ...                   |           |
    |                   .. +PADDING |           |
  ? +-------------------------------+&lt;----------|
    | Signature ...                 |
    |                   .. +PADDING |
    +-------------------------------+
</code></pre>
<p><a href="rationale.html#layout">Rationale</a></p>
<h2 id="sections-and-fields">Sections and Fields</h2>
<p>Records contain the following sections and fields.</p>
<hr />
<h3 id="id">ID</h3>
<p>A 48 byte ID from <code>[0:48]</code> made up of the following two parts:</p>
<h4 id="timestamp">Timestamp</h4>
<p>8 bytes from <code>[0:8]</code></p>
<p>This is the big-endian unsigned 64-bit timestamp as described in <a href="timestamps.html">timestamps</a>,
which represents the number of nanoseconds that have elapsed since 1 January 1970
including within leap seconds.</p>
<h4 id="hash">Hash</h4>
<p>40 bytes at <code>[8:48]</code></p>
<p>This is the first 40 bytes of the BLAKE3 hash of the data section ([48:152+LenT+LenP]).</p>
<hr />
<h3 id="data-section">Data Section</h3>
<p>After the ID comes the data section which contains everything else except the
digital signature.</p>
<h4 id="address">Address</h4>
<p>A 48 byte Address from <code>[48:96]</code> made up of the following three parts.
<a href="rationale.html#address-fields"><sup>ref</sup></a></p>
<h5 id="unique-address-nonce">Unique Address Nonce</h5>
<p>8 bytes at <code>[48:56]</code>. These bytes MUST start with a 1 bit.</p>
<p>These bytes make an address unique (within the context of an author and a
kind). They can be created in a number of different ways, depending on the
application and its purpose:</p>
<ol>
<li>They can be generated randomly.</li>
<li>They can be a timestamp, modified with a leading 1 bit.
   This is useful when the addresses should sort in time order.</li>
<li>They can be the first 8 bytes of a BLAKE3 hash of a fixed slice
   of bytes. This is useful for applications that require seeking a
   record by a known fixed string of bytes (with known author and kind).</li>
<li>They can be copied from a previous record, to replace or version that
   record if the kind is replaceable or versioned.</li>
</ol>
<p>The method of creation is determined by the application layer.</p>
<h5 id="kind">Kind</h5>
<p>A <a href="kind.html">kind</a>, represented in 8 bytes at <code>[56:64]</code>.</p>
<h5 id="author-public-key">Author Public Key</h5>
<p>32 bytes at <code>[64:96]</code></p>
<p>This is the identity of the author expressed as their master key.</p>
<p>For ed25519 and secp256k1 it is the master key public key itself.</p>
<p>For post-quantum cryptosystems with larger public keys, it is a 32 byte BLAKE3
hash of the public key.</p>
<h4 id="signing-public-key">Signing Public Key</h4>
<p>32 bytes at <code>[96:128]</code></p>
<p>This is the public key of the signing keypair.</p>
<p>The signing keypair is usually a subkey under the author's master keypair, but
theoretically could be delegated in some other fashion in the future.  For
some records, it is the master public key itself.</p>
<p>For post-quantum cryptosystems with larger public keys, it is a 32 byte BLAKE3
hash of the signing key.</p>
<h4 id="timestamp_1">Timestamp</h4>
<p>8 bytes at <code>[128:136]</code></p>
<p>This is the big-endian unsigned 64-bit timestamp as described in <a href="timestamps.html">timestamps</a>,
which represents the number of nanoseconds that have elapsed since 1 January 1970
including within leap seconds.</p>
<p>It is repeated in the ID, but this copy is digitally signed by being included in the data
section and thus hashed, whereas the timestamp in the ID is not hashed or signed and is there
for sorting purposes.</p>
<h4 id="flags">Flags</h4>
<p>8 bytes at <code>[136:144]</code> with the following meanings:</p>
<ul>
<li>Byte 0:  Cryptosystem byte<ul>
<li>bits 0-3 indicate the master key cryptosystem<ul>
<li>0 represents the ed25519 cryptosystem</li>
<li>1 represents the secp256k1 cryptosystem with standard mosaic signature</li>
<li>2 represents the secp256k1 cryptosystem using nostr's signature scheme where
  the data is layed out in JSON and signed according to
  nostr <a href="https://github.com/nostr-protocol/nips/blob/master/01.md">NIP-01</a>.
  See TBD for details of how to embed a nostr event into Mosaic.</li>
<li>Other values are currently RESERVED</li>
</ul>
</li>
<li>bits 4-7 indicate the signing key cryptosystem, using the same value definitions as for the master key.</li>
</ul>
</li>
<li>Byte 1:  Various Flags<ul>
<li>bit 0: <code>ZSTD</code> - If 1, the payload is compressed with Zstd</li>
<li>bit 1: RESERVED</li>
<li>bit 2: <code>FROM_AUTHOR</code> - If 1, servers SHOULD only accept the record from the author (requiring authentication)</li>
<li>bit 3-5: RESERVED</li>
</ul>
</li>
<li>Bytes 2-7: RESERVED</li>
</ul>
<p>All reserved bits SHOULD be 0.
If any reserved bits in bytes 0-3 are set, software MUST reject the record.
If any reserved bits in bytes 4-7 are set, software SHOULD ignore them and accept the record.</p>
<h4 id="lent">LenT</h4>
<p>2 bytes at <code>[144:146]</code> representing the exact length of the tags section in bytes
(not counting padding) as an unsigned integer in little-endian format.</p>
<p>The maximum tags section length is 65536 bytes.</p>
<h5 id="lentpad">LenTPad</h5>
<p>This value is NOT included in the record, it is calculated.</p>
<p>The length of the tags section including padding is called <code>LenTPad</code> and is
calculated as <code>(LenT + 7) &amp; !7</code></p>
<h4 id="lens">LenS</h4>
<p>2 bytes at <code>[146:148]</code> representing the exact length of the signature section in bytes
(not counting padding) as an unsigned integer in little-endian format.</p>
<p>The maximum signature section length is 65536 bytes.</p>
<p>For ed25519 and secp256k1 cryptosystems, the signature section will be 64 bytes long.
For post-quantum schemes, the signature length will depend on the precise scheme.</p>
<h5 id="lenspad">LenSPad</h5>
<p>This value is NOT included in the record, it is calculated.</p>
<p>The length of the signature section including padding is called <code>LenSPad</code> and is
calculated as <code>(LenS + 7) &amp; !7</code></p>
<h4 id="lenp">LenP</h4>
<p>4 bytes at <code>[148:152]</code> representing the exact length of the payload section in bytes
(not counting padding) as an unsigned integer in little-endian format.</p>
<p>The maximum payload section length is whatever fits such that the entire record
remains within 1,048,576 bytes.</p>
<h5 id="lenppad">LenPPad</h5>
<p>This is NOT included in the record, it is calculated.</p>
<p>The length of the payload section including padding is called <code>LenPPad</code> and is
calculated as <code>(LenP + 7) &amp; !7</code></p>
<h4 id="tags">Tags</h4>
<p>Varying bytes at <code>[152:152+LenT]</code></p>
<p>These are searchable key-value <a href="tags.html">tags</a>.</p>
<p>The tags section is padded out to 64-bit alignment.</p>
<p>The maximum tags section length is 65536 bytes.</p>
<p>Tag types are documented at the <a href="tag_types.html">Tag Type Registry</a>
which includes the defined <a href="core_tags.html">Core Tags</a>.</p>
<h4 id="payload">Payload</h4>
<p>Varying bytes at <code>[152+LenTPad:152+LenTPad+LenP].</code></p>
<p>Payload is application specific data, and is opaque at this layer of specification,
except for records defined by the Core Application.</p>
<p>The payload section is padded out to 64-bit alignment.</p>
<p>The maximum payload section length is 1_048_384 bytes (which is the maximum record
size minus the header size).</p>
<h3 id="signature">Signature</h3>
<p>Varying bytes at <code>[152+LenTPad+LenPPad:152+LenTPad+LenPPad+LenS].</code></p>
<p>This is the signature of the full hash of the data section, produced according to the
cryptosystem and the <a href="#construction">construction</a> procedure.</p>
<h1 id="construction">Construction</h1>
<h2 id="fill-in-the-data-section">Fill in the Data Section</h2>
<p>Fill in the data section from <code>[48:152+LenTPad+LenPPad]</code>.</p>
<p>LenS should be a constant determined from the cryptosystem of the signing key.</p>
<h2 id="hash-the-data-section">Hash the Data Section</h2>
<p>Take a BLAKE3 hash of the data section from <code>[48:152+LenTPad+LenPPad]</code>,
unkeyed, and extend this to 64 bytes of output using BLAKE3's
<code>finalize_xof()</code> function. This 64 byte (512-bit) hash does not directly
go into the record.</p>
<h2 id="create-and-attach-a-signature">Create and Attach a signature</h2>
<p>Generate pre-hashed signature of the 64 byte (512-bit) BLAKE3 hash
generated in step 2 using the Signing secret key, according to its
cryptosystem. Place the signature into the signature section.</p>
<h2 id="fill-in-the-id">Fill in the ID</h2>
<ul>
<li>Copy the first 40 bytes of the hash generated earlier to <code>[8:48]</code>.</li>
<li>Copy the 64-bit timestamp from <code>[128:136]</code> to <code>[0:8]</code>.</li>
</ul>
<h1 id="validation">Validation</h1>
<p>Records MUST be fully validated by clients.</p>
<p>Records MUST be fully validated by servers upon receipt except for the
steps marked CLIENTS ONLY.</p>
<p>Validation steps:</p>
<ol>
<li>The length must be between 152 and 1048576 bytes.</li>
<li>The length must equal 152 + LenTPad + LenPPad + LenSPad.</li>
<li>LenS must be correct for the cryptosystem specified by the flags</li>
<li>The Signing public key MUST be validated according to the
   <a href="cryptography.html">cryptography</a> key validation checks.</li>
<li>The Author public key MUST be validated according to the
   <a href="cryptography.html">cryptography</a> key validation checks.</li>
<li>CLIENTS ONLY: The Signing public key MUST be verified to be
   a non-revoked subkey of the Author via the Author's
   <a href="bootstrap.html">bootstrap</a>.</li>
<li>Take a BLAKE3 hash of the data section from <code>[48:152+LenTPad+LenPPad]</code>,
   unkeyed, and extend this to 64 bytes of output using BLAKE3's
   <code>finalize_xof()</code> function.</li>
<li>Verify the hash: Compare bytes <code>[0:40]</code> of this hash with bytes
   <code>[8:48]</code> of the record. They must match or validation has failed.</li>
<li>Verify the ID timestamp: bytes <code>[0:8]</code> must be equal to bytes <code>[128:136]</code>.</li>
<li>Verify the signature: The signature must be valid for the cryptosystem
    specified in the flags for the signing key.</li>
<li>Reserved flags in flag bytes 4-7 must be 0, or else the record should
    be rejected.</li>
<li>CLIENTS ONLY: Application specific validation SHOULD be performed.</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
      <div class="md-copyright">
        <i>Mike Dilger edition, version 0.1.0</i>
      </div>
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.path"], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>