<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>Cryptography - Mosaic</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="style.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Cryptography";
        var mkdocs_page_input_path = "cryptography.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".">
          <img src="img/favicon-96x96.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Introduction</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="status.html">Status and Development</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="rationale.html">Rationale</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Identity</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="identity.html">Identity</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Location Service</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="bootstrap.html">Bootstrap</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="url.html">URL</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Data Formats</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="timestamps.html">Timestamps</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="core_tags.html">Core Tags</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="record.html">Record Format</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="human_readable_content.html">Human Readable Content</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="reference.html">References</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Client-Server Protocol</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="network.html">Network architecture</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="transport_requirements.html">Transport requirements</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="messages.html">Protocol messages</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="filter.html">Filter</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="sync.html">Sync</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Transport layer</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="quic.html">QUIC</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="websockets.html">WebSockets</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Accessory</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="human_encodings.html">Human Encodings</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="encrypted_secret_key.html">Encrypted Secret Key</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Registries</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="applications.html">Application Registry</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="kinds.html">Record Kind Registry</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="tag_types.html">Tag Type Registry</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Application: Core</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="keyschedule.html">Key Schedule Record</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="profile.html">Profile Record</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="friends.html">Acquaintences and Friends</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="reporting.html">Reporting</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Appendices</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Cryptography</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#hashing-with-blake3">Hashing with BLAKE3</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#digital-signature-with-eddsa-ed25519">Digital Signature with EdDSA ed25519</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#encryption">Encryption</a>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Application: Mosaic Social Media</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="microblog.html">Microblogging</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="blog.html">Blog</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="reply_comment.html">Reply Comment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="chat.html">Chat</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href=".">Mosaic</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Appendices</li>
      <li class="breadcrumb-item active">Cryptography</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="cryptography">Cryptography</h1>
<p><status>PAGE STATUS: early draft</status></p>
<h2 id="hashing-with-blake3">Hashing with BLAKE3</h2>
<p>Mosaic uses BLAKE3 <a href="rationale.html#blake3"><sup>rat</sup></a>
in unkeyed hashing mode, producing a 512-bit digest. The entire digest is
used within the EdDSA ed25519 signing algorithm, and a prefix of this digest is used within
the record Id.</p>
<p>Refer to the <a href="https://github.com/BLAKE3-team/BLAKE3">BLAKE3 github page</a></p>
<h2 id="digital-signature-with-eddsa-ed25519">Digital Signature with EdDSA ed25519</h2>
<p>We use <t>EdDSA with the ed25519 curve</t> <a href="rationale.html#eddsa-ed25519"><sup>rat</sup></a>
in a non-standard way. In particular</p>
<ul>
<li>We use ed25519ph, pre-hashed. We substitute <a href="#hashing-with-blake3">BLAKE3</a> for SHA-512.</li>
<li>We provide a context string of "Mosaic".</li>
<li>We require very specific public key and signature validation checks. In particular:<ul>
<li>Public keys should be rejected if they are one of 8 small order points.</li>
<li>Signatures must be rejected if s is not within the range <code>0..L-1</code>.</li>
<li>Signatures must be rejected if R or A are non-canonical
  (e.g. verify that <code>|R| &gt;= L</code> and <code>|A| &gt;= L</code>)</li>
<li>Always use cofactor verification <code>(8(S · B) − 8R − 8(h · A) = 0)</code> not the
  non-cofactor one, even when not in batch mode.</li>
</ul>
</li>
</ul>
<h2 id="encryption">Encryption</h2>
<p>Encryption is NOT YET DEFINED at the Mosaic Core level, but may be in the future.</p>
<p>Notes on how we might do it:</p>
<ul>
<li>Use ECIES</li>
<li>Do the diffie-hellman between<ul>
<li>an ephemeral keypair generated by the sender and used only once, and</li>
<li>one of the recipient's x25519 public keys (published in their key
  schedule), which is not ephemeral but may nonetheless be frequently
  rolled over by the recipient.</li>
</ul>
</li>
</ul>
<p>In order for a user to decrypt on any of their devices, they must share the x25519 public key's
secret to all of their devices. In order to preserve signing security, these keys are separate
from ed25519 signing keys. See <a href="keyschedule.html">keyschedule</a> marker 0x2.</p>
<p>See also <a href="https://www.cryptosys.net/pki/manpki/pki_eccsafecurves.html">this page at cryptosys.net</a></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="reporting.html" class="btn btn-neutral float-left" title="Reporting"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="microblog.html" class="btn btn-neutral float-right" title="Microblogging">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  <div>
    <i>Mike Dilger edition, version 0.1.0</i>
  </div>
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="reporting.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="microblog.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script>var base_url = ".";</script>
    <script src="js/theme_extra.js"></script>
    <script src="js/theme.js"></script>
      <script src="search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
