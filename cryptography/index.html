<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Cryptography - Mosaic</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../style.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Cryptography";
        var mkdocs_page_input_path = "cryptography.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="..">
          <img src="../img/favicon-96x96.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Mosaic Introduction</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../status/">Status and Development</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Mosaic Core</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" >Identity</a>
    <ul class="current">
                <li class="toctree-l2 current"><a class="reference internal current" href="#">Cryptography</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../identity/">Identity</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../bootstrap/">Bootstrap</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Record Type</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../timestamps/">Timestamps</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../record/">Record Format</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../core_tags/">Core Tags</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../reference/">References</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Core Records</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../keyschedule/">Key Schedule Record</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../profile/">Profile Record</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Protocol</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../filter/">Filter</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../protocol/">Core Protocol</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Registries</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../tag_types/">Tag Type Registry</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../kinds/">Record Kind Registry</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Mosaic Transport</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../websockets/">WebSockets</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../webtransport/">WebTransport</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../rest/">REST</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Extensions</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../sync_protocol_extension/">Sync Protocol Extension</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Applications</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Mosaic Social media</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../microblog/">Microblogging</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../blog/">Blog</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../reply_comment/">Reply Comment</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../chat/">Chat</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Mosaic</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Mosaic Core</li>
          <li class="breadcrumb-item">Identity</li>
      <li class="breadcrumb-item active">Cryptography</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="cryptography">Cryptography</h1>
<p><status>PAGE STATUS: early draft</status></p>
<h2 id="hashing">Hashing</h2>
<p>We use BLAKE3 in unkeyed hashing mode, producing a 512-bit digest,
storing only the first 256-bits in the record but passing the full
512-bits into EdDSA</p>
<p>Rationale:</p>
<ul>
<li>EdDSA ed25519 is defined to use SHA-512 and we are using BLAKE3 as a
  drop-in replacement, so we have to produce 512-bit hashes. But these
  do not need to be in the record. What the record needs is some way to
  index and reference it, and the 256 bit prefix is enough for that.
  In BLAKE3, hashes are variable size, and smaller outputs are prefixes
  of longer outputs.</li>
<li>This is a very fast hash function with 128-bit security. It is even
  sometimes faster in software than hardware versions of SHA-256, and
  is about 14x as fast as software versions of SHA-256. It is highly
  parallelizable and can take advantage of vector instructions.</li>
<li>It's predecessor BLAKE was the most analyzed algorithm during the NIST
  SHA-3 competition.</li>
</ul>
<h2 id="digital-signature">Digital Signature</h2>
<p>We use EdDSA with the ed25519 curve and very specific public key and signature
validation checks. In particular:</p>
<ul>
<li>Public keys should be rejected if they are one of 8 small order points.</li>
<li>Signatures must be rejected if s is not within the range 0..L-1.</li>
<li>Signatures must be rejected if R or A are non-canonical
  (e.g. verify that |R| &gt;= L and |A| &gt;= L)</li>
<li>Always use cofactor verification (8(S · B) − 8R − 8(h · A) = 0) not the
  non-cofactor one, even when not in batch mode.</li>
</ul>
<p>Rationale:</p>
<ul>
<li>Fast and space efficient</li>
<li>Widely studied</li>
<li>Very good resistance to side-channel attacks</li>
<li>Does not require point validation</li>
<li>In our form, provides the following guarantees:<ul>
<li>Existentially and Strongly unforgeable under chosen message attacks</li>
<li>Strongly Binding Signature</li>
</ul>
</li>
<li>Interoperates with TLS, Mainline DHT, and other modern ed25519-based
  identity systems</li>
</ul>
<p>See <a href="https://eprint.iacr.org/2020/1244.pdf">Taming the many EdDSAs</a></p>
<p>See <a href="https://eprint.iacr.org/2020/823.pdf">The Provable Security of Ed25519: Theory and Practice</a></p>
<h2 id="encryption">Encryption</h2>
<p>Records in Mosaic are generally not encrypted, but public things. However some
applications have a need to encrypt data.</p>
<p>This is a general specification of how encryption is done.</p>
<p>Encryption details are still TBD but we intend:</p>
<ul>
<li>To use ECIES</li>
<li>To do the diffie-hellman between<ul>
<li>an ephemeral keypair generated by the sender and used only once, and</li>
<li>one of the recipient's x25519 public keys (published in their key
  schedule), which is not ephemeral but may nonetheless be frequently
  rolled over by the recipient.</li>
</ul>
</li>
</ul>
<p>In order for a user to decrypt on any of their devices, they must share the
x25519 public key's secret to all of their devices. In order to preserve
signing security, these keys are separate from ed25519 signing keys.
See <a href="../keyschedule/">keyschedule</a> marker 0x2.</p>
<p>See also <a href="https://www.cryptosys.net/pki/manpki/pki_eccsafecurves.html">this page at cryptosys.net</a></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../status/" class="btn btn-neutral float-left" title="Status and Development"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../identity/" class="btn btn-neutral float-right" title="Identity">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  <div>
    <i>Steve Farroll edition</i>
  </div>
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../status/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../identity/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
